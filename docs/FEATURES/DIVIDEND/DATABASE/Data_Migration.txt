-- =============================================
-- Phoenix DMS5A 資料遷移腳本 (SQL Server)
-- 來源: Oracle Linked Server ORA_UAT
-- 產生時間: 2025-11-25 18:15:15
-- =============================================

USE [DMS_UAT]
GO

SET NOCOUNT ON;
SET XACT_ABORT ON;

-- =============================================
-- 表格: FAS.DIVIDEND
-- =============================================
PRINT N'步驟 01: 清空 FAS.DIVIDEND 資料...';
TRUNCATE TABLE FAS.DIVIDEND;

PRINT N'步驟 01: 匯入 FAS.DIVIDEND 資料...';
INSERT INTO FAS.DIVIDEND (
    FUND_NO,
    DIVIDEND_YEAR,
    DIVIDEND_DATE,
    REFERENCE_DATE,
    CASH_DIVIDEND,
    STOCK_DIVIDEND,
    INTEREST_INCOME,
    INTEREST_S_NOTES,
    REALIZED_GAIN,
    INCOME_EQUALIZATION,
    PAY_DATE,
    PAYMENT_DATE,
    NEXT_DIVIDEND_DATE,
    DIVIDEND_RATE,
    STATUS,
    EX_RATE,
    EVALUATED_DATE,
    STOCK_RATE,
    INTEREST_RATE,
    SECURITY_RATE,
    EMP_NO,
    LAST_MODIFIED,
    DIVIDEND_TYPE,
    REALLY_DIV_DATE,
    SECURITY_RATE_ONSHORE,
    YEAR_RATE,
    CAPITAL_RATE,
    INTEREST_RATE_F
)
SELECT
    FUND_NO,
    DIVIDEND_YEAR,
    DIVIDEND_DATE,
    REFERENCE_DATE,
    CASH_DIVIDEND,
    STOCK_DIVIDEND,
    INTEREST_INCOME,
    INTEREST_S_NOTES,
    REALIZED_GAIN,
    INCOME_EQUALIZATION,
    PAY_DATE,
    PAYMENT_DATE,
    NEXT_DIVIDEND_DATE,
    DIVIDEND_RATE,
    STATUS,
    EX_RATE,
    EVALUATED_DATE,
    STOCK_RATE,
    INTEREST_RATE,
    SECURITY_RATE,
    EMP_NO,
    LAST_MODIFIED,
    DIVIDEND_TYPE,
    REALLY_DIV_DATE,
    SECURITY_RATE_ONSHORE,
    YEAR_RATE,
    CAPITAL_RATE,
    INTEREST_RATE_F
FROM ORA_UAT..FAS.DIVIDEND
WHERE FUND_NO IS NOT NULL AND DIVIDEND_DATE IS NOT NULL AND DIVIDEND_TYPE IS NOT NULL;

PRINT N'FAS.DIVIDEND 資料遷移完成';

-- =============================================
-- 表格: FAS.FUND
-- =============================================
PRINT N'步驟 02: 清空 FAS.FUND 資料...';
TRUNCATE TABLE FAS.FUND;

PRINT N'步驟 02: 匯入 FAS.FUND 資料...';
INSERT INTO FAS.FUND (
    FUND_NO,
    NAME,
    SNAME,
    FUND_TYPE,
    MAX_SHARE,
    INCEPTION_DATE,
    CUSTODIAN,
    CO_NO,
    TERM_NO,
    ID,
    PAY_DAY,
    IS_PERIODIC,
    FORMULA_RED_FEE,
    PREV_DATE,
    AC_DATE,
    VISA_DATE,
    LAST_CER_NO,
    LAST_S_STAT_NO,
    LAST_P_STAT_NO,
    IS_POSTED,
    FIRST_RED_DATE,
    MF_RATE,
    IS_EC,
    IS_VC,
    BEHIND_DAYS,
    IS_CCC,
    IS_SSS,
    ORDINAL,
    ENAME,
    SSNAME,
    CUSTODIAN_RECIPIENT,
    CUSTODIAN_FAX,
    MIN_AMOUNT,
    MAX_CHANGE,
    TAX_NO,
    MEDIA_NO,
    VAT,
    CTCB_FUND_NO,
    CTCB_AC_CODE,
    PERIOD_MIN,
    CLEAR_DATE,
    UWCB_FUND_NO,
    UWCB_AC_CODE,
    IS_EC_PERIODIC,
    EC_PERIOD_MIN,
    EC_MIN_AMOUNT,
    CUSTODIAN_BANK_NO,
    TW_RATE,
    VARIABLE_MF,
    NAV_DECIMAL,
    EMP_NO,
    LAST_MODIFIED,
    AREA_TYPE,
    IS_MAX_SHARE,
    BANK_NO,
    BRANCH_NO,
    CURRENCY_NO,
    FUND_TYPE2,
    OFFERING_TYPE,
    AMT_DECIMAL,
    SHARE_DECIMAL,
    MIN_RED_SHARE,
    MIN_BAL_SHARE,
    PUR_CUT_OFF,
    RED_CUT_OFF,
    CALENDAR_CODE,
    FUND_CATEGORY,
    SHARE_CLASS,
    ISIN_CODE,
    AMC_NO,
    RED_NAV_DAY,
    MIN_BAL_AMOUNT,
    EC_DIFF,
    EC_DEDUCTION,
    EC_REMITTANCE,
    EC_ATM,
    DEXIA_CODE,
    FEE_RATE,
    RESET_PERIOD,
    EARLY_RED_MIN_DAYS,
    EARLY_RED_FEE_RATE,
    IS_PERFORMANCE_FEE,
    ANNUALIZED_ROI,
    ROUNDING_SHARE,
    T0_CODE,
    HSBC_CODE,
    MIN_INITIAL_PURCHASE,
    MIN_RED_AMOUNT,
    PUR_NAV_DAY,
    IS_EC_PURCHASE,
    IS_EC_REDEMPTION,
    EC_PUR_CUT_OFF,
    EC_RED_CUT_OFF,
    LAUNCH_DATE,
    INVESTMENT_LINK,
    DIVIDEND_FREQ,
    AC_NAME,
    TX_CALENDAR_CODE,
    MIN_INITIAL_PURCHASE_NTD,
    MIN_AMOUNT_NTD,
    PERIOD_MIN_NTD,
    MIN_RED_AMOUNT_NTD,
    MIN_BAL_AMOUNT_NTD,
    EC_PERIOD_MIN_NTD,
    EC_MIN_AMOUNT_NTD,
    REDEMPTION_RULE,
    IS_EC_SWITCH_IN,
    IS_WIRE_FEE,
    RISK_CATEGORY,
    CORE_SATELLITE,
    TDCC_CODE,
    END_COLLECTION_DATE,
    SITCA_FUND_TYPE,
    ELIMINATION_DATE,
    EC_RSP_NEW,
    EC_RSP_UPDATE,
    FUND_GROUP,
    DIVIDEND_RATE,
    DIVIDEND_MIN,
    RSP_CHANGE,
    FAX_PUR_CUT_OFF,
    FUND_SET,
    TSCD_NAV_UPLOAD_TYPE,
    FUND_MASTER_NO,
    DIVIDEND_DESC,
    GLOBAL_CURRENCY,
    HEDGING_TYPE,
    CREATED_BY,
    CREATION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    IS_EC_DRSP,
    EC_DRSP_NEW,
    EC_DRSP_UPDATE,
    RED_BANK_NO,
    RED_BRANCH_NO,
    RED_AC_CODE,
    DIVIDEND_BANK_NO,
    DIVIDEND_BRANCH_NO,
    DIVIDEND_AC_CODE,
    BANK_WIRE_FEE,
    IS_TDCC,
    TDCC_DEBIT_CUT_OFF,
    TDCC_REMIT_CUT_OFF,
    TDCC_RED_CUT_OFF,
    SUBTA_NO,
    NTD_RSP_RANGE,
    ORG_RSP_RANGE,
    INVESTMENT_TYPE,
    SERVICE_CHARGE_TYPE,
    DUE_EXCHANGE_TYPE,
    DUE_EXCHANGE_FUND,
    BEL_BASE,
    BEL_YEAR,
    BEL_EXG_DAY,
    SALES_DATE,
    OPERATION_FEE_RATE,
    MATURITY_DATE,
    IS_PURCHASE,
    RECEIPT_FREQ,
    RECEIPT_CALENDAR_CODE,
    RECEIPT_DAY,
    PUR_DISCOUNT,
    SF_RATE,
    CF_RATE,
    OF_RATE,
    SALES_TYPE,
    IS_MAX_SHARE_RATE1,
    IS_MAX_SHARE_RATE2,
    REGISTRATION,
    IS_ROBO
)
SELECT
    FUND_NO,
    NAME,
    SNAME,
    FUND_TYPE,
    MAX_SHARE,
    INCEPTION_DATE,
    CUSTODIAN,
    CO_NO,
    TERM_NO,
    ID,
    PAY_DAY,
    IS_PERIODIC,
    FORMULA_RED_FEE,
    PREV_DATE,
    AC_DATE,
    VISA_DATE,
    LAST_CER_NO,
    LAST_S_STAT_NO,
    LAST_P_STAT_NO,
    IS_POSTED,
    FIRST_RED_DATE,
    MF_RATE,
    IS_EC,
    IS_VC,
    BEHIND_DAYS,
    IS_CCC,
    IS_SSS,
    ORDINAL,
    ENAME,
    SSNAME,
    CUSTODIAN_RECIPIENT,
    CUSTODIAN_FAX,
    MIN_AMOUNT,
    MAX_CHANGE,
    TAX_NO,
    MEDIA_NO,
    VAT,
    CTCB_FUND_NO,
    CTCB_AC_CODE,
    PERIOD_MIN,
    CLEAR_DATE,
    UWCB_FUND_NO,
    UWCB_AC_CODE,
    IS_EC_PERIODIC,
    EC_PERIOD_MIN,
    EC_MIN_AMOUNT,
    CUSTODIAN_BANK_NO,
    TW_RATE,
    VARIABLE_MF,
    NAV_DECIMAL,
    EMP_NO,
    LAST_MODIFIED,
    AREA_TYPE,
    IS_MAX_SHARE,
    BANK_NO,
    BRANCH_NO,
    CURRENCY_NO,
    FUND_TYPE2,
    OFFERING_TYPE,
    AMT_DECIMAL,
    SHARE_DECIMAL,
    MIN_RED_SHARE,
    MIN_BAL_SHARE,
    PUR_CUT_OFF,
    RED_CUT_OFF,
    CALENDAR_CODE,
    FUND_CATEGORY,
    SHARE_CLASS,
    ISIN_CODE,
    AMC_NO,
    RED_NAV_DAY,
    MIN_BAL_AMOUNT,
    EC_DIFF,
    EC_DEDUCTION,
    EC_REMITTANCE,
    EC_ATM,
    DEXIA_CODE,
    FEE_RATE,
    RESET_PERIOD,
    EARLY_RED_MIN_DAYS,
    EARLY_RED_FEE_RATE,
    IS_PERFORMANCE_FEE,
    ANNUALIZED_ROI,
    ROUNDING_SHARE,
    T0_CODE,
    HSBC_CODE,
    MIN_INITIAL_PURCHASE,
    MIN_RED_AMOUNT,
    PUR_NAV_DAY,
    IS_EC_PURCHASE,
    IS_EC_REDEMPTION,
    EC_PUR_CUT_OFF,
    EC_RED_CUT_OFF,
    LAUNCH_DATE,
    INVESTMENT_LINK,
    DIVIDEND_FREQ,
    AC_NAME,
    TX_CALENDAR_CODE,
    MIN_INITIAL_PURCHASE_NTD,
    MIN_AMOUNT_NTD,
    PERIOD_MIN_NTD,
    MIN_RED_AMOUNT_NTD,
    MIN_BAL_AMOUNT_NTD,
    EC_PERIOD_MIN_NTD,
    EC_MIN_AMOUNT_NTD,
    REDEMPTION_RULE,
    IS_EC_SWITCH_IN,
    IS_WIRE_FEE,
    RISK_CATEGORY,
    CORE_SATELLITE,
    TDCC_CODE,
    END_COLLECTION_DATE,
    SITCA_FUND_TYPE,
    ELIMINATION_DATE,
    EC_RSP_NEW,
    EC_RSP_UPDATE,
    FUND_GROUP,
    DIVIDEND_RATE,
    DIVIDEND_MIN,
    RSP_CHANGE,
    FAX_PUR_CUT_OFF,
    FUND_SET,
    TSCD_NAV_UPLOAD_TYPE,
    FUND_MASTER_NO,
    DIVIDEND_DESC,
    GLOBAL_CURRENCY,
    HEDGING_TYPE,
    CREATED_BY,
    CREATION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    IS_EC_DRSP,
    EC_DRSP_NEW,
    EC_DRSP_UPDATE,
    RED_BANK_NO,
    RED_BRANCH_NO,
    RED_AC_CODE,
    DIVIDEND_BANK_NO,
    DIVIDEND_BRANCH_NO,
    DIVIDEND_AC_CODE,
    BANK_WIRE_FEE,
    IS_TDCC,
    TDCC_DEBIT_CUT_OFF,
    TDCC_REMIT_CUT_OFF,
    TDCC_RED_CUT_OFF,
    SUBTA_NO,
    NTD_RSP_RANGE,
    ORG_RSP_RANGE,
    INVESTMENT_TYPE,
    SERVICE_CHARGE_TYPE,
    DUE_EXCHANGE_TYPE,
    DUE_EXCHANGE_FUND,
    BEL_BASE,
    BEL_YEAR,
    BEL_EXG_DAY,
    SALES_DATE,
    OPERATION_FEE_RATE,
    MATURITY_DATE,
    IS_PURCHASE,
    RECEIPT_FREQ,
    RECEIPT_CALENDAR_CODE,
    RECEIPT_DAY,
    PUR_DISCOUNT,
    SF_RATE,
    CF_RATE,
    OF_RATE,
    SALES_TYPE,
    IS_MAX_SHARE_RATE1,
    IS_MAX_SHARE_RATE2,
    REGISTRATION,
    IS_ROBO
FROM ORA_UAT..FAS.FUND
WHERE FUND_NO IS NOT NULL;

PRINT N'FAS.FUND 資料遷移完成';

-- =============================================
-- 表格: FAS.FUND_LEDGE
-- =============================================
PRINT N'步驟 03: 清空 FAS.FUND_LEDGE 資料...';
TRUNCATE TABLE FAS.FUND_LEDGE;

PRINT N'步驟 03: 匯入 FAS.FUND_LEDGE 資料...';
INSERT INTO FAS.FUND_LEDGE (
    FUND_NO,
    AC_DATE,
    PUR_SHARE,
    PER_SHARE,
    RED_SHARE,
    BAL_SHARE,
    PUR_AMOUNT,
    PER_AMOUNT,
    RED_AMOUNT,
    PUR_QTY,
    PER_QTY,
    RED_QTY,
    ACQ_SHARE
)
SELECT
    FUND_NO,
    AC_DATE,
    PUR_SHARE,
    PER_SHARE,
    RED_SHARE,
    BAL_SHARE,
    PUR_AMOUNT,
    PER_AMOUNT,
    RED_AMOUNT,
    PUR_QTY,
    PER_QTY,
    RED_QTY,
    ACQ_SHARE
FROM ORA_UAT..FAS.FUND_LEDGE
WHERE FUND_NO IS NOT NULL AND AC_DATE IS NOT NULL;

PRINT N'FAS.FUND_LEDGE 資料遷移完成';

-- =============================================
-- 表格: FAS.SALES
-- =============================================
PRINT N'步驟 04: 清空 FAS.SALES 資料...';
TRUNCATE TABLE FAS.SALES;

PRINT N'步驟 04: 匯入 FAS.SALES 資料...';
INSERT INTO FAS.SALES (
    SALES_NO,
    NAME,
    BROKER_NO,
    BRANCH_NO,
    STATUS,
    DEPT_NO,
    AC_BANK,
    AC_BRANCH,
    AC_SNAME,
    AC_CODE,
    EMP_NO,
    LAST_MODIFIED,
    SALES_TYPE,
    START_DATE,
    LEAVE_DATE,
    INSTALL_DATE,
    ADJUST_DATE,
    RANK,
    SALES_NO1,
    NAME1,
    TEL
)
SELECT
    SALES_NO,
    NAME,
    BROKER_NO,
    BRANCH_NO,
    STATUS,
    DEPT_NO,
    AC_BANK,
    AC_BRANCH,
    AC_SNAME,
    AC_CODE,
    EMP_NO,
    LAST_MODIFIED,
    SALES_TYPE,
    START_DATE,
    LEAVE_DATE,
    INSTALL_DATE,
    ADJUST_DATE,
    RANK,
    SALES_NO1,
    NAME1,
    TEL
FROM ORA_UAT..FAS.SALES
WHERE SALES_NO IS NOT NULL;

PRINT N'FAS.SALES 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIV
-- =============================================
PRINT N'步驟 05: 清空 MDS.FUND_DIV 資料...';
TRUNCATE TABLE MDS.FUND_DIV;

PRINT N'步驟 05: 匯入 MDS.FUND_DIV 資料...';
INSERT INTO MDS.FUND_DIV (
    FUND_NO,
    DIVIDEND_YEAR,
    DIVIDEND_DATE,
    DIVIDEND_TYPE,
    PAY_DATE,
    PAYMENT_DATE,
    NEXT_DIVIDEND_DATE,
    REALLY_DIV_DATE,
    UNIT,
    NAV,
    PRE_DIV1,
    PRE_DIV1_RATE,
    PRE_DIV1_ADJ,
    PRE_DIV2,
    PRE_DIV2_RATE,
    PRE_DIV2_ADJ,
    PRE_DIV3,
    PRE_DIV3_RATE,
    PRE_DIV3_ADJ,
    PRE_DIV4,
    PRE_DIV4_RATE,
    PRE_DIV4_ADJ,
    PRE_DIV5,
    PRE_DIV5_RATE,
    PRE_DIV5_ADJ,
    DIV1,
    DIV1_RATE,
    DIV_ADJ,
    DIV2,
    DIV2_RATE,
    DIV2_ADJ,
    DIV3,
    DIV3_RATE,
    DIV3_ADJ,
    DIV4,
    DIV4_RATE,
    DIV4_ADJ,
    DIV5,
    DIV5_RATE,
    DIV5_ADJ,
    FEE,
    DIV_TOT,
    DIV_RATE,
    DIV_RATE_M,
    CAPITAL,
    CAPITAL_RATE,
    CAPITAL_ADJ,
    DIV_OBJ,
    STEP1_CRE_EMP,
    STEP1_CRE_TIME,
    STEP1_COF_EMP,
    STEP1_COF_TIME,
    STEP1_STATUS,
    STEP2_CRE_EMP,
    STEP2_CRE_TIME,
    STEP2_COF_EMP,
    STEP2_COF_TIME,
    STEP3_CRE_EMP,
    STEP2_STATUS,
    STEP3_CRE_TIME,
    STEP3_COF_EMP,
    STEP3_COF_TIME,
    STEP3_STATUS,
    STEP4_CRE_EMP,
    STEP4_CRE_TIME,
    STEP4_COF_EMP,
    STEP4_COF_TIME,
    STEP4_STATUS,
    PRE_DIV1_RATE_M,
    PRE_DIV2_RATE_M,
    PRE_DIV3_RATE_M,
    PRE_DIV4_RATE_M,
    PRE_DIV5_RATE_M,
    DIV1_RATE_M,
    DIV2_RATE_M,
    DIV3_RATE_M,
    DIV4_RATE_M,
    DIV5_RATE_M,
    FEE_RATE,
    FEE_RATE_M,
    CAPITAL_RATE_M,
    DIV_PRE,
    I_RATE,
    C_RATE,
    DIV_RATE_O,
    STEP5_CRE_EMP,
    STEP5_CRE_TIME,
    STEP5_COF_EMP,
    STEP5_COF_TIME,
    STEP5_STATUS,
    PRE_DIV1_B,
    DIV1_B
)
SELECT
    FUND_NO,
    DIVIDEND_YEAR,
    DIVIDEND_DATE,
    DIVIDEND_TYPE,
    PAY_DATE,
    PAYMENT_DATE,
    NEXT_DIVIDEND_DATE,
    REALLY_DIV_DATE,
    UNIT,
    NAV,
    PRE_DIV1,
    PRE_DIV1_RATE,
    PRE_DIV1_ADJ,
    PRE_DIV2,
    PRE_DIV2_RATE,
    PRE_DIV2_ADJ,
    PRE_DIV3,
    PRE_DIV3_RATE,
    PRE_DIV3_ADJ,
    PRE_DIV4,
    PRE_DIV4_RATE,
    PRE_DIV4_ADJ,
    PRE_DIV5,
    PRE_DIV5_RATE,
    PRE_DIV5_ADJ,
    DIV1,
    DIV1_RATE,
    DIV_ADJ,
    DIV2,
    DIV2_RATE,
    DIV2_ADJ,
    DIV3,
    DIV3_RATE,
    DIV3_ADJ,
    DIV4,
    DIV4_RATE,
    DIV4_ADJ,
    DIV5,
    DIV5_RATE,
    DIV5_ADJ,
    FEE,
    DIV_TOT,
    DIV_RATE,
    DIV_RATE_M,
    CAPITAL,
    CAPITAL_RATE,
    CAPITAL_ADJ,
    DIV_OBJ,
    STEP1_CRE_EMP,
    STEP1_CRE_TIME,
    STEP1_COF_EMP,
    STEP1_COF_TIME,
    STEP1_STATUS,
    STEP2_CRE_EMP,
    STEP2_CRE_TIME,
    STEP2_COF_EMP,
    STEP2_COF_TIME,
    STEP3_CRE_EMP,
    STEP2_STATUS,
    STEP3_CRE_TIME,
    STEP3_COF_EMP,
    STEP3_COF_TIME,
    STEP3_STATUS,
    STEP4_CRE_EMP,
    STEP4_CRE_TIME,
    STEP4_COF_EMP,
    STEP4_COF_TIME,
    STEP4_STATUS,
    PRE_DIV1_RATE_M,
    PRE_DIV2_RATE_M,
    PRE_DIV3_RATE_M,
    PRE_DIV4_RATE_M,
    PRE_DIV5_RATE_M,
    DIV1_RATE_M,
    DIV2_RATE_M,
    DIV3_RATE_M,
    DIV4_RATE_M,
    DIV5_RATE_M,
    FEE_RATE,
    FEE_RATE_M,
    CAPITAL_RATE_M,
    DIV_PRE,
    I_RATE,
    C_RATE,
    DIV_RATE_O,
    STEP5_CRE_EMP,
    STEP5_CRE_TIME,
    STEP5_COF_EMP,
    STEP5_COF_TIME,
    STEP5_STATUS,
    PRE_DIV1_B,
    DIV1_B
FROM ORA_UAT..MDS.FUND_DIV
WHERE FUND_NO IS NOT NULL AND DIVIDEND_DATE IS NOT NULL AND DIVIDEND_TYPE IS NOT NULL;

PRINT N'MDS.FUND_DIV 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIVIDEND
-- =============================================
PRINT N'步驟 06: 清空 MDS.FUND_DIVIDEND 資料...';
TRUNCATE TABLE MDS.FUND_DIVIDEND;

PRINT N'步驟 06: 匯入 MDS.FUND_DIVIDEND 資料...';
INSERT INTO MDS.FUND_DIVIDEND (
    FUND_NO,
    FUND_NAME,
    DIVIDEND_TYPE,
    DIVIDEND_YEAR,
    DIVIDEND_MONTH,
    UNIT_DIVIDEND_RATE,
    DIVIDEND_DATE,
    NEXT_DIVIDEND_DATE,
    PAYMENT_DATE,
    NAV,
    ROI,
    MONTH_DIVIDEND_RATE,
    YEAR_DIVIDEND_RATE,
    REMARK,
    FUND_CATEGORY,
    CAPITAL_RATE,
    INTEREST_RATE,
    PAY_DATE,
    FLAG,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    REVIEWED_BY_C,
    REVIEW_DATE_C,
    STATUS_C,
    REVISED_BY_C,
    REVISION_DATE_C
)
SELECT
    FUND_NO,
    FUND_NAME,
    DIVIDEND_TYPE,
    DIVIDEND_YEAR,
    DIVIDEND_MONTH,
    UNIT_DIVIDEND_RATE,
    DIVIDEND_DATE,
    NEXT_DIVIDEND_DATE,
    PAYMENT_DATE,
    NAV,
    ROI,
    MONTH_DIVIDEND_RATE,
    YEAR_DIVIDEND_RATE,
    REMARK,
    FUND_CATEGORY,
    CAPITAL_RATE,
    INTEREST_RATE,
    PAY_DATE,
    FLAG,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    REVIEWED_BY_C,
    REVIEW_DATE_C,
    STATUS_C,
    REVISED_BY_C,
    REVISION_DATE_C
FROM ORA_UAT..MDS.FUND_DIVIDEND
WHERE FUND_NO IS NOT NULL AND DIVIDEND_TYPE IS NOT NULL AND DIVIDEND_YEAR IS NOT NULL AND DIVIDEND_MONTH IS NOT NULL AND DIVIDEND_DATE IS NOT NULL;

PRINT N'MDS.FUND_DIVIDEND 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIVIDEND_LOG
-- =============================================
PRINT N'步驟 07: 清空 MDS.FUND_DIVIDEND_LOG 資料...';
TRUNCATE TABLE MDS.FUND_DIVIDEND_LOG;

PRINT N'步驟 07: 匯入 MDS.FUND_DIVIDEND_LOG 資料...';
INSERT INTO MDS.FUND_DIVIDEND_LOG (
    FUND_NO,
    FUND_NAME,
    DIVIDEND_TYPE,
    DIVIDEND_YEAR,
    DIVIDEND_MONTH,
    UNIT_DIVIDEND_RATE,
    DIVIDEND_DATE,
    NEXT_DIVIDEND_DATE,
    PAYMENT_DATE,
    NAV,
    ROI,
    MONTH_DIVIDEND_RATE,
    YEAR_DIVIDEND_RATE,
    REMARK,
    FUND_CATEGORY,
    CAPITAL_RATE,
    INTEREST_RATE,
    PAY_DATE,
    FLAG,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    LOG_TYPE,
    LOG_EMP_NO,
    LOG_DATE,
    ORG_FUND_NO,
    ORG_DIVIDEND_TYPE,
    ORG_DIVIDEND_YEAR,
    ORG_DIVIDEND_MONTH,
    ORG_DIVIDEND_DATE,
    REVIEWED_BY_C,
    REVIEW_DATE_C,
    STATUS_C,
    REVISED_BY_C,
    REVISION_DATE_C
)
SELECT
    FUND_NO,
    FUND_NAME,
    DIVIDEND_TYPE,
    DIVIDEND_YEAR,
    DIVIDEND_MONTH,
    UNIT_DIVIDEND_RATE,
    DIVIDEND_DATE,
    NEXT_DIVIDEND_DATE,
    PAYMENT_DATE,
    NAV,
    ROI,
    MONTH_DIVIDEND_RATE,
    YEAR_DIVIDEND_RATE,
    REMARK,
    FUND_CATEGORY,
    CAPITAL_RATE,
    INTEREST_RATE,
    PAY_DATE,
    FLAG,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    LOG_TYPE,
    LOG_EMP_NO,
    LOG_DATE,
    ORG_FUND_NO,
    ORG_DIVIDEND_TYPE,
    ORG_DIVIDEND_YEAR,
    ORG_DIVIDEND_MONTH,
    ORG_DIVIDEND_DATE,
    REVIEWED_BY_C,
    REVIEW_DATE_C,
    STATUS_C,
    REVISED_BY_C,
    REVISION_DATE_C
FROM ORA_UAT..MDS.FUND_DIVIDEND_LOG
WHERE FUND_NO IS NOT NULL AND DIVIDEND_TYPE IS NOT NULL AND DIVIDEND_YEAR IS NOT NULL AND DIVIDEND_MONTH IS NOT NULL AND DIVIDEND_DATE IS NOT NULL;

PRINT N'MDS.FUND_DIVIDEND_LOG 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIV_EMAIL
-- =============================================
PRINT N'步驟 08: 清空 MDS.FUND_DIV_EMAIL 資料...';
TRUNCATE TABLE MDS.FUND_DIV_EMAIL;

PRINT N'步驟 08: 匯入 MDS.FUND_DIV_EMAIL 資料...';
INSERT INTO MDS.FUND_DIV_EMAIL (
    STEP_NO,
    FA_EMAIL,
    TA_EMAIL,
    PM_EMAIL,
    FM_EMAIL,
    IT_EMAIL
)
SELECT
    STEP_NO,
    FA_EMAIL,
    TA_EMAIL,
    PM_EMAIL,
    FM_EMAIL,
    IT_EMAIL
FROM ORA_UAT..MDS.FUND_DIV_EMAIL
WHERE STEP_NO IS NOT NULL;

PRINT N'MDS.FUND_DIV_EMAIL 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIV_EXEC_LOG
-- =============================================
PRINT N'步驟 09: 清空 MDS.FUND_DIV_EXEC_LOG 資料...';
TRUNCATE TABLE MDS.FUND_DIV_EXEC_LOG;

PRINT N'步驟 09: 匯入 MDS.FUND_DIV_EXEC_LOG 資料...';
INSERT INTO MDS.FUND_DIV_EXEC_LOG (
    PRG_ID,
    EMP_NO,
    EXEC_TIME,
    REMARK,
    SUB_EXEC_TIME
)
SELECT
    PRG_ID,
    EMP_NO,
    EXEC_TIME,
    REMARK,
    SUB_EXEC_TIME
FROM ORA_UAT..MDS.FUND_DIV_EXEC_LOG
WHERE PRG_ID IS NOT NULL OR EMP_NO IS NOT NULL;

PRINT N'MDS.FUND_DIV_EXEC_LOG 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIV_LOG
-- =============================================
PRINT N'步驟 10: 清空 MDS.FUND_DIV_LOG 資料...';
TRUNCATE TABLE MDS.FUND_DIV_LOG;

PRINT N'步驟 10: 匯入 MDS.FUND_DIV_LOG 資料...';
INSERT INTO MDS.FUND_DIV_LOG (
    FUND_NO,
    DIVIDEND_YEAR,
    DIVIDEND_DATE,
    DIVIDEND_TYPE,
    PAY_DATE,
    PAYMENT_DATE,
    NEXT_DIVIDEND_DATE,
    REALLY_DIV_DATE,
    UNIT,
    NAV,
    PRE_DIV1,
    PRE_DIV1_RATE,
    PRE_DIV1_ADJ,
    PRE_DIV2,
    PRE_DIV2_RATE,
    PRE_DIV2_ADJ,
    PRE_DIV3,
    PRE_DIV3_RATE,
    PRE_DIV3_ADJ,
    PRE_DIV4,
    PRE_DIV4_RATE,
    PRE_DIV4_ADJ,
    PRE_DIV5,
    PRE_DIV5_RATE,
    PRE_DIV5_ADJ,
    DIV1,
    DIV1_RATE,
    DIV_ADJ,
    DIV2,
    DIV2_RATE,
    DIV2_ADJ,
    DIV3,
    DIV3_RATE,
    DIV3_ADJ,
    DIV4,
    DIV4_RATE,
    DIV4_ADJ,
    DIV5,
    DIV5_RATE,
    DIV5_ADJ,
    FEE,
    DIV_TOT,
    DIV_RATE,
    DIV_RATE_M,
    CAPITAL,
    CAPITAL_RATE,
    CAPITAL_ADJ,
    DIV_OBJ,
    LOG_TYPE,
    LOG_EMP_NO,
    LOG_DATE,
    ORG_FUND_NO,
    ORG_DIVIDEND_DATE,
    ORG_DIVIDEND_TYPE,
    PRE_DIV1_RATE_M,
    PRE_DIV2_RATE_M,
    PRE_DIV3_RATE_M,
    PRE_DIV4_RATE_M,
    PRE_DIV5_RATE_M,
    DIV1_RATE_M,
    DIV2_RATE_M,
    DIV3_RATE_M,
    DIV4_RATE_M,
    DIV5_RATE_M,
    FEE_RATE,
    FEE_RATE_M,
    CAPITAL_RATE_M,
    DIV_PRE,
    I_RATE,
    C_RATE
)
SELECT
    FUND_NO,
    DIVIDEND_YEAR,
    DIVIDEND_DATE,
    DIVIDEND_TYPE,
    PAY_DATE,
    PAYMENT_DATE,
    NEXT_DIVIDEND_DATE,
    REALLY_DIV_DATE,
    UNIT,
    NAV,
    PRE_DIV1,
    PRE_DIV1_RATE,
    PRE_DIV1_ADJ,
    PRE_DIV2,
    PRE_DIV2_RATE,
    PRE_DIV2_ADJ,
    PRE_DIV3,
    PRE_DIV3_RATE,
    PRE_DIV3_ADJ,
    PRE_DIV4,
    PRE_DIV4_RATE,
    PRE_DIV4_ADJ,
    PRE_DIV5,
    PRE_DIV5_RATE,
    PRE_DIV5_ADJ,
    DIV1,
    DIV1_RATE,
    DIV_ADJ,
    DIV2,
    DIV2_RATE,
    DIV2_ADJ,
    DIV3,
    DIV3_RATE,
    DIV3_ADJ,
    DIV4,
    DIV4_RATE,
    DIV4_ADJ,
    DIV5,
    DIV5_RATE,
    DIV5_ADJ,
    FEE,
    DIV_TOT,
    DIV_RATE,
    DIV_RATE_M,
    CAPITAL,
    CAPITAL_RATE,
    CAPITAL_ADJ,
    DIV_OBJ,
    LOG_TYPE,
    LOG_EMP_NO,
    LOG_DATE,
    ORG_FUND_NO,
    ORG_DIVIDEND_DATE,
    ORG_DIVIDEND_TYPE,
    PRE_DIV1_RATE_M,
    PRE_DIV2_RATE_M,
    PRE_DIV3_RATE_M,
    PRE_DIV4_RATE_M,
    PRE_DIV5_RATE_M,
    DIV1_RATE_M,
    DIV2_RATE_M,
    DIV3_RATE_M,
    DIV4_RATE_M,
    DIV5_RATE_M,
    FEE_RATE,
    FEE_RATE_M,
    CAPITAL_RATE_M,
    DIV_PRE,
    I_RATE,
    C_RATE
FROM ORA_UAT..MDS.FUND_DIV_LOG
WHERE FUND_NO IS NOT NULL AND DIVIDEND_DATE IS NOT NULL AND DIVIDEND_TYPE IS NOT NULL;

PRINT N'MDS.FUND_DIV_LOG 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIV_OBJ
-- =============================================
PRINT N'步驟 11: 清空 MDS.FUND_DIV_OBJ 資料...';
TRUNCATE TABLE MDS.FUND_DIV_OBJ;

PRINT N'步驟 11: 匯入 MDS.FUND_DIV_OBJ 資料...';
INSERT INTO MDS.FUND_DIV_OBJ (
    FUND_NO,
    DIV_TYPE,
    TX_DATE,
    DIV_OBJ,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    DIV_OBJ_AMT
)
SELECT
    FUND_NO,
    DIV_TYPE,
    TX_DATE,
    DIV_OBJ,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    DIV_OBJ_AMT
FROM ORA_UAT..MDS.FUND_DIV_OBJ
WHERE FUND_NO IS NOT NULL AND DIV_TYPE IS NOT NULL AND TX_DATE IS NOT NULL;

PRINT N'MDS.FUND_DIV_OBJ 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIV_OBJ_LOG
-- =============================================
PRINT N'步驟 12: 清空 MDS.FUND_DIV_OBJ_LOG 資料...';
TRUNCATE TABLE MDS.FUND_DIV_OBJ_LOG;

PRINT N'步驟 12: 匯入 MDS.FUND_DIV_OBJ_LOG 資料...';
INSERT INTO MDS.FUND_DIV_OBJ_LOG (
    FUND_NO,
    DIV_TYPE,
    TX_DATE,
    DIV_OBJ,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    LOG_TYPE,
    LOG_EMP_NO,
    LOG_DATE,
    ORG_FUND_NO,
    ORG_DIV_TYPE,
    ORG_TX_DATE
)
SELECT
    FUND_NO,
    DIV_TYPE,
    TX_DATE,
    DIV_OBJ,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    LOG_TYPE,
    LOG_EMP_NO,
    LOG_DATE,
    ORG_FUND_NO,
    ORG_DIV_TYPE,
    ORG_TX_DATE
FROM ORA_UAT..MDS.FUND_DIV_OBJ_LOG
WHERE FUND_NO IS NOT NULL AND DIV_TYPE IS NOT NULL AND TX_DATE IS NOT NULL;

PRINT N'MDS.FUND_DIV_OBJ_LOG 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIV_SET
-- =============================================
PRINT N'步驟 13: 清空 MDS.FUND_DIV_SET 資料...';
TRUNCATE TABLE MDS.FUND_DIV_SET;

PRINT N'步驟 13: 匯入 MDS.FUND_DIV_SET 資料...';
INSERT INTO MDS.FUND_DIV_SET (
    FUND_NO,
    DIV_TYPE,
    ITEM01_SEQ,
    ITEM01_SEQ_ADJ,
    ITEM01_TYPE,
    ITEM02_SEQ,
    ITEM02_SEQ_ADJ,
    ITEM02_TYPE,
    ITEM03_SEQ,
    ITEM03_SEQ_ADJ,
    ITEM03_TYPE,
    ITEM04_SEQ,
    ITEM04_SEQ_ADJ,
    ITEM04_TYPE,
    ITEM05_SEQ,
    ITEM05_SEQ_ADJ,
    ITEM05_TYPE,
    ITEM06_SEQ,
    ITEM06_SEQ_ADJ,
    ITEM06_TYPE,
    ITEM07_SEQ,
    ITEM07_SEQ_ADJ,
    ITEM07_TYPE,
    ITEM08_SEQ,
    ITEM08_SEQ_ADJ,
    ITEM08_TYPE,
    ITEM09_SEQ,
    ITEM09_SEQ_ADJ,
    ITEM09_TYPE,
    ITEM10_SEQ,
    ITEM10_SEQ_ADJ,
    ITEM10_TYPE,
    FEE_TYPE,
    CAPITAL_TYPE,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    EMAIL_LIST,
    FIRST_DIVIDEND_DATE,
    FIRST_DIVIDEND_COUNT
)
SELECT
    FUND_NO,
    DIV_TYPE,
    ITEM01_SEQ,
    ITEM01_SEQ_ADJ,
    ITEM01_TYPE,
    ITEM02_SEQ,
    ITEM02_SEQ_ADJ,
    ITEM02_TYPE,
    ITEM03_SEQ,
    ITEM03_SEQ_ADJ,
    ITEM03_TYPE,
    ITEM04_SEQ,
    ITEM04_SEQ_ADJ,
    ITEM04_TYPE,
    ITEM05_SEQ,
    ITEM05_SEQ_ADJ,
    ITEM05_TYPE,
    ITEM06_SEQ,
    ITEM06_SEQ_ADJ,
    ITEM06_TYPE,
    ITEM07_SEQ,
    ITEM07_SEQ_ADJ,
    ITEM07_TYPE,
    ITEM08_SEQ,
    ITEM08_SEQ_ADJ,
    ITEM08_TYPE,
    ITEM09_SEQ,
    ITEM09_SEQ_ADJ,
    ITEM09_TYPE,
    ITEM10_SEQ,
    ITEM10_SEQ_ADJ,
    ITEM10_TYPE,
    FEE_TYPE,
    CAPITAL_TYPE,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    EMAIL_LIST,
    FIRST_DIVIDEND_DATE,
    FIRST_DIVIDEND_COUNT
FROM ORA_UAT..MDS.FUND_DIV_SET
WHERE FUND_NO IS NOT NULL AND DIV_TYPE IS NOT NULL;

PRINT N'MDS.FUND_DIV_SET 資料遷移完成';

-- =============================================
-- 表格: MDS.FUND_DIV_SET_LOG
-- =============================================
PRINT N'步驟 14: 清空 MDS.FUND_DIV_SET_LOG 資料...';
TRUNCATE TABLE MDS.FUND_DIV_SET_LOG;

PRINT N'步驟 14: 匯入 MDS.FUND_DIV_SET_LOG 資料...';
INSERT INTO MDS.FUND_DIV_SET_LOG (
    FUND_NO,
    DIV_TYPE,
    ITEM01_SEQ,
    ITEM01_SEQ_ADJ,
    ITEM01_TYPE,
    ITEM02_SEQ,
    ITEM02_SEQ_ADJ,
    ITEM02_TYPE,
    ITEM03_SEQ,
    ITEM03_SEQ_ADJ,
    ITEM03_TYPE,
    ITEM04_SEQ,
    ITEM04_SEQ_ADJ,
    ITEM04_TYPE,
    ITEM05_SEQ,
    ITEM05_SEQ_ADJ,
    ITEM05_TYPE,
    ITEM06_SEQ,
    ITEM06_SEQ_ADJ,
    ITEM06_TYPE,
    ITEM07_SEQ,
    ITEM07_SEQ_ADJ,
    ITEM07_TYPE,
    ITEM08_SEQ,
    ITEM08_SEQ_ADJ,
    ITEM08_TYPE,
    ITEM09_SEQ,
    ITEM09_SEQ_ADJ,
    ITEM09_TYPE,
    ITEM10_SEQ,
    ITEM10_SEQ_ADJ,
    ITEM10_TYPE,
    FEE_TYPE,
    CAPITAL_TYPE,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    LOG_TYPE,
    LOG_EMP_NO,
    LOG_DATE,
    ORG_FUND_NO,
    ORG_DIV_TYPE,
    EMAIL_LIST
)
SELECT
    FUND_NO,
    DIV_TYPE,
    ITEM01_SEQ,
    ITEM01_SEQ_ADJ,
    ITEM01_TYPE,
    ITEM02_SEQ,
    ITEM02_SEQ_ADJ,
    ITEM02_TYPE,
    ITEM03_SEQ,
    ITEM03_SEQ_ADJ,
    ITEM03_TYPE,
    ITEM04_SEQ,
    ITEM04_SEQ_ADJ,
    ITEM04_TYPE,
    ITEM05_SEQ,
    ITEM05_SEQ_ADJ,
    ITEM05_TYPE,
    ITEM06_SEQ,
    ITEM06_SEQ_ADJ,
    ITEM06_TYPE,
    ITEM07_SEQ,
    ITEM07_SEQ_ADJ,
    ITEM07_TYPE,
    ITEM08_SEQ,
    ITEM08_SEQ_ADJ,
    ITEM08_TYPE,
    ITEM09_SEQ,
    ITEM09_SEQ_ADJ,
    ITEM09_TYPE,
    ITEM10_SEQ,
    ITEM10_SEQ_ADJ,
    ITEM10_TYPE,
    FEE_TYPE,
    CAPITAL_TYPE,
    CREATED_BY,
    CREATION_DATE,
    REVISED_BY,
    REVISION_DATE,
    REVIEWED_BY,
    REVIEW_DATE,
    STATUS,
    LOG_TYPE,
    LOG_EMP_NO,
    LOG_DATE,
    ORG_FUND_NO,
    ORG_DIV_TYPE,
    EMAIL_LIST
FROM ORA_UAT..MDS.FUND_DIV_SET_LOG
WHERE FUND_NO IS NOT NULL AND DIV_TYPE IS NOT NULL;

PRINT N'MDS.FUND_DIV_SET_LOG 資料遷移完成';

-- =============================================
-- 表格: NAV.NAV
-- =============================================
PRINT N'步驟 15: 清空 NAV.NAV 資料...';
TRUNCATE TABLE NAV.NAV;

PRINT N'步驟 15: 匯入 NAV.NAV 資料...';
INSERT INTO NAV.NAV (
    FUND_NO,
    NAV_DATE,
    TX_DATE,
    NAV,
    CHANGE,
    BAL_SHARE,
    NET_ASSET
)
SELECT
    FUND_NO,
    NAV_DATE,
    TX_DATE,
    NAV,
    CHANGE,
    BAL_SHARE,
    NET_ASSET
FROM ORA_UAT..NAV.NAV
WHERE FUND_NO IS NOT NULL AND NAV_DATE IS NOT NULL;

PRINT N'NAV.NAV 資料遷移完成';

-- =============================================
-- 表格: SMS.AP_PERMISSION
-- =============================================
PRINT N'步驟 16: 清空 SMS.AP_PERMISSION 資料...';
TRUNCATE TABLE SMS.AP_PERMISSION;

PRINT N'步驟 16: 匯入 SMS.AP_PERMISSION 資料...';
INSERT INTO SMS.AP_PERMISSION (
    AP_CODE,
    ROLE_ID,
    MENU_ID,
    PER_ENABLED,
    INSERT_STATE,
    DELETE_STATE,
    UPDATE_STATE,
    PRINT_STATE,
    DATA_EXPORT,
    EXTENSION1,
    EXTENSION2,
    EXTENSION3
)
SELECT
    AP_CODE,
    ROLE_ID,
    MENU_ID,
    PER_ENABLED,
    INSERT_STATE,
    DELETE_STATE,
    UPDATE_STATE,
    PRINT_STATE,
    DATA_EXPORT,
    EXTENSION1,
    EXTENSION2,
    EXTENSION3
FROM ORA_UAT..SMS.AP_PERMISSION
WHERE AP_CODE IS NOT NULL AND ROLE_ID IS NOT NULL AND MENU_ID IS NOT NULL;

PRINT N'SMS.AP_PERMISSION 資料遷移完成';

-- =============================================
-- 表格: WPS.FUND_DIVIDEND
-- =============================================
PRINT N'步驟 17: 清空 WPS.FUND_DIVIDEND 資料...';
TRUNCATE TABLE WPS.FUND_DIVIDEND;

PRINT N'步驟 17: 匯入 WPS.FUND_DIVIDEND 資料...';
INSERT INTO WPS.FUND_DIVIDEND (
    FUND_NO,
    FUND_NAME,
    DIVIDEND_TYPE,
    DIVIDEND_YEAR,
    DIVIDEND_MONTH,
    UNIT_DIVIDEND_RATE,
    DIVIDEND_DATE,
    NEXT_DIVIDEND_DATE,
    PAYMENT_DATE,
    NAV,
    ROI,
    MONTH_DIVIDEND_RATE,
    YEAR_DIVIDEND_RATE,
    REMARK,
    FUND_CATEGORY,
    INTEREST_DIVIDEND,
    PRINCIPAL_DIVIDEND,
    PAY_DATE,
    EMP_NO,
    FUNC,
    LAST_MODIFIED
)
SELECT
    FUND_NO,
    FUND_NAME,
    DIVIDEND_TYPE,
    DIVIDEND_YEAR,
    DIVIDEND_MONTH,
    UNIT_DIVIDEND_RATE,
    DIVIDEND_DATE,
    NEXT_DIVIDEND_DATE,
    PAYMENT_DATE,
    NAV,
    ROI,
    MONTH_DIVIDEND_RATE,
    YEAR_DIVIDEND_RATE,
    REMARK,
    FUND_CATEGORY,
    INTEREST_DIVIDEND,
    PRINCIPAL_DIVIDEND,
    PAY_DATE,
    EMP_NO,
    FUNC,
    LAST_MODIFIED
FROM ORA_UAT..WPS.FUND_DIVIDEND
WHERE FUND_NO IS NOT NULL AND DIVIDEND_TYPE IS NOT NULL AND DIVIDEND_YEAR IS NOT NULL AND DIVIDEND_MONTH IS NOT NULL AND DIVIDEND_DATE IS NOT NULL;

PRINT N'WPS.FUND_DIVIDEND 資料遷移完成';

PRINT N'開始驗證資料遷移結果...';
SELECT 'FAS.DIVIDEND' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM FAS.DIVIDEND
UNION ALL
SELECT 'FAS.FUND' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM FAS.FUND
UNION ALL
SELECT 'FAS.FUND_LEDGE' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM FAS.FUND_LEDGE
UNION ALL
SELECT 'FAS.SALES' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM FAS.SALES
UNION ALL
SELECT 'MDS.FUND_DIV' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIV
UNION ALL
SELECT 'MDS.FUND_DIVIDEND' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIVIDEND
UNION ALL
SELECT 'MDS.FUND_DIVIDEND_LOG' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIVIDEND_LOG
UNION ALL
SELECT 'MDS.FUND_DIV_EMAIL' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIV_EMAIL
UNION ALL
SELECT 'MDS.FUND_DIV_EXEC_LOG' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIV_EXEC_LOG
UNION ALL
SELECT 'MDS.FUND_DIV_LOG' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIV_LOG
UNION ALL
SELECT 'MDS.FUND_DIV_OBJ' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIV_OBJ
UNION ALL
SELECT 'MDS.FUND_DIV_OBJ_LOG' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIV_OBJ_LOG
UNION ALL
SELECT 'MDS.FUND_DIV_SET' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIV_SET
UNION ALL
SELECT 'MDS.FUND_DIV_SET_LOG' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM MDS.FUND_DIV_SET_LOG
UNION ALL
SELECT 'NAV.NAV' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM NAV.NAV
UNION ALL
SELECT 'SMS.AP_PERMISSION' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM SMS.AP_PERMISSION
UNION ALL
SELECT 'WPS.FUND_DIVIDEND' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM WPS.FUND_DIVIDEND
PRINT N'資料遷移驗證完成';

GO

-- =============================================
-- 使用說明
-- =============================================
/*
1. 確認 ORA_UAT 已連線至 Oracle UAT/PROD 對應環境。
2. 如需重新匯入，請先備份目標資料或取消 TRUNCATE。
3. 可視需要拆批執行，避免鎖表。
4. 驗證段落可協助比對筆數。
*/
