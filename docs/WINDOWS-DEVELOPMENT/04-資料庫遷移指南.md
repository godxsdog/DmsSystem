# Windows 環境資料庫操作指南

## 📊 資料庫連線與管理

### 連接正式區 SQL Server

**使用 SQL Server Management Studio (SSMS)**

1. 開啟 SSMS
2. 輸入伺服器位址、使用者名稱和密碼
3. 連接資料庫

**使用命令列**

```powershell
sqlcmd -S 正式伺服器位址 -U 正式使用者 -P 正式密碼 -d DMS
```

## 🔄 資料庫備份

### 使用 SSMS 備份

1. 右鍵點擊資料庫 → 工作 → 備份
2. 選擇備份類型（完整、差異、交易記錄）
3. 設定備份目的地
4. 執行備份

### 使用命令列備份

```powershell
sqlcmd -S 正式伺服器位址 -U 正式使用者 -P 正式密碼 -Q "BACKUP DATABASE DMS TO DISK='C:\Backup\DMS.bak'"
```

## 📥 資料庫還原

### 使用 SSMS 還原

1. 右鍵點擊資料庫 → 工作 → 還原 → 資料庫
2. 選擇備份檔案
3. 設定還原選項
4. 執行還原

### 使用命令列還原

```powershell
sqlcmd -S 正式伺服器位址 -U 正式使用者 -P 正式密碼 -Q "RESTORE DATABASE DMS FROM DISK='C:\Backup\DMS.bak' WITH REPLACE"
```

## 🔍 資料庫驗證

### 檢查資料庫連線

```powershell
sqlcmd -S 正式伺服器位址 -U 正式使用者 -P 正式密碼 -d DMS -Q "SELECT DB_NAME()"
```

### 檢查資料表

```powershell
sqlcmd -S 正式伺服器位址 -U 正式使用者 -P 正式密碼 -d DMS -Q "SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES"
```

### 檢查資料筆數

```powershell
sqlcmd -S 正式伺服器位址 -U 正式使用者 -P 正式密碼 -d DMS -Q "SELECT COUNT(*) FROM ris.shmtsource1"
```

## ⚠️ 重要提醒

1. **備份**：執行任何資料庫操作前，請先備份資料庫
2. **權限**：確認使用者帳號有足夠的資料庫操作權限
3. **測試**：在正式環境操作前，請先在測試環境驗證
4. **記錄**：記錄所有資料庫操作的時間和內容

## 📚 相關文件

- [資料庫配置](../03-資料庫配置.md) - 資料庫連接設定
- [Windows 開發環境完整手冊](./01-Windows開發環境完整手冊.md) - 完整環境設定
