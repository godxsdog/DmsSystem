# 系統測試報告

## 📋 測試環境

- **作業系統**：macOS
- **.NET 版本**：.NET 8.0
- **資料庫**：SQL Server 2022 (Docker)
- **測試時間**：$(date)

## ✅ 建置測試

### 後端 API
- **狀態**：✅ 建置成功
- **警告**：10 個警告（主要為 Nullable 相關，不影響功能）
- **錯誤**：0 個錯誤

### 前端
- **狀態**：✅ 依賴安裝成功
- **套件**：177 個套件已安裝

## 🔍 功能測試

### 1. API 啟動測試

**測試步驟：**
```bash
cd DmsSystem.Api
dotnet run
```

**結果：**
- ✅ API 成功啟動
- ✅ 監聽在 http://localhost:5137
- ✅ Swagger UI 可訪問

**注意事項：**
- 首次啟動時，如果資料表不存在會出現錯誤
- 需要先執行資料表建立腳本

### 2. 資料庫連接測試

**測試步驟：**
1. 確認 SQL Server 容器運行
2. 測試連接字串

**結果：**
- ✅ SQL Server 容器正在運行
- ⚠️ 需要建立資料表結構

### 3. 前端啟動測試

**測試步驟：**
```bash
cd react-client
npm install
npm run dev
```

**結果：**
- ✅ 依賴安裝成功
- ⚠️ 需要手動啟動測試

## 📝 測試檢查清單

### 資料庫設定
- [ ] SQL Server 容器運行中
- [ ] 資料庫 DMS 已建立
- [ ] Schema RIS 和 DMS 已建立
- [ ] 資料表已建立（SHMT_SOURCE1, SHMT_SOURCE4, STOCK_BALANCE）
- [ ] 測試資料已載入

### API 測試
- [ ] API 可以啟動
- [ ] Swagger UI 可訪問
- [ ] 可以查詢股東會明細資料
- [ ] 可以查詢公司資訊
- [ ] 可以查詢股票餘額
- [ ] 可以上傳檔案

### 前端測試
- [ ] 前端可以啟動
- [ ] 可以連接到 API
- [ ] 可以顯示資料列表
- [ ] 可以上傳檔案
- [ ] 錯誤訊息正確顯示

## 🐛 已知問題

### 1. 資料表不存在

**問題**：首次啟動時，資料表可能不存在

**解決方案：**
1. 執行資料表建立腳本：`scripts/create-tables.sql`
2. 或使用 EF Core Migrations 建立資料表

### 2. SQL Server 連接工具路徑

**問題**：不同版本的 SQL Server 容器，sqlcmd 路徑可能不同

**解決方案：**
- 使用 `-C` 參數信任憑證
- 或使用 Azure Data Studio 等工具

## 🚀 完整測試流程

### 步驟 1：建立資料表

```bash
# 複製腳本到容器
docker cp scripts/create-tables.sql dms-sqlserver:/tmp/create-tables.sql

# 執行腳本（使用 TrustServerCertificate）
docker exec dms-sqlserver bash -c "/opt/mssql-tools*/bin/sqlcmd -S localhost -U sa -P 'DmsSystem@2024' -d DMS -C -i /tmp/create-tables.sql"
```

### 步驟 2：載入測試資料

```bash
docker cp scripts/seed-test-data.sql dms-sqlserver:/tmp/seed-test-data.sql
docker exec dms-sqlserver bash -c "/opt/mssql-tools*/bin/sqlcmd -S localhost -U sa -P 'DmsSystem@2024' -d DMS -C -i /tmp/seed-test-data.sql"
```

### 步驟 3：啟動 API

```bash
cd DmsSystem.Api
dotnet run
```

### 步驟 4：測試 API

```bash
# 測試 Swagger
curl http://localhost:5137/swagger

# 測試資料查詢
curl http://localhost:5137/api/DataView/shareholder-meetings
```

### 步驟 5：啟動前端

```bash
cd react-client
npm run dev
```

### 步驟 6：測試前端

1. 打開瀏覽器訪問 http://localhost:5173
2. 點擊「資料檢視」標籤
3. 確認可以顯示資料
4. 測試檔案上傳功能

## 📊 測試結果總結

| 項目 | 狀態 | 備註 |
|------|------|------|
| 建置 | ✅ 成功 | 有警告但不影響功能 |
| 資料庫連接 | ✅ 成功 | 容器運行正常 |
| API 啟動 | ✅ 成功 | 需要先建立資料表 |
| 前端啟動 | ⏳ 待測試 | 需要手動啟動 |
| 資料查詢 | ⏳ 待測試 | 需要資料表存在 |
| 檔案上傳 | ⏳ 待測試 | 需要完整測試 |

## 🔧 下一步

1. **建立資料表**：執行 `scripts/create-tables.sql`
2. **載入測試資料**：執行 `scripts/seed-test-data.sql`
3. **完整功能測試**：按照測試流程逐一測試
4. **修正問題**：根據測試結果修正發現的問題

---

**測試完成後，請更新此報告的測試結果。**

